/**
 * Minified by jsDelivr using Terser v5.15.1.
 * Original file: /npm/bodymovin@4.13.0/player/js/utils/shapes/TrimModifier.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
function TrimModifier(){}extendPrototype(ShapeModifier,TrimModifier),TrimModifier.prototype.processKeys=function(e){if(this.elem.globalData.frameId!==this.frameId||e){this.mdf=!!e,this.frameId=this.elem.globalData.frameId;var t,s=this.dynamicProperties.length;for(t=0;t<s;t+=1)this.dynamicProperties[t].getValue(),this.dynamicProperties[t].mdf&&(this.mdf=!0);if(this.mdf||e){var h=this.o.v%360/360;h<0&&(h+=1);var a=this.s.v+h,i=this.e.v+h;if(a>i){var p=a;a=i,i=p}this.sValue=a,this.eValue=i,this.oValue=h}}},TrimModifier.prototype.initModifierProperties=function(e,t){this.sValue=0,this.eValue=0,this.oValue=0,this.getValue=this.processKeys,this.s=PropertyFactory.getProp(e,t.s,0,.01,this.dynamicProperties),this.e=PropertyFactory.getProp(e,t.e,0,.01,this.dynamicProperties),this.o=PropertyFactory.getProp(e,t.o,0,0,this.dynamicProperties),this.m=t.m,this.dynamicProperties.length||this.getValue(!0)},TrimModifier.prototype.calculateShapeEdges=function(e,t,s,h,a){var i=[];t<=1?i.push({s:e,e:t}):e>=1?i.push({s:e-1,e:t-1}):(i.push({s:e,e:1}),i.push({s:0,e:t-1}));var p,o,r=[],d=i.length;for(p=0;p<d;p+=1){var n,l;if((o=i[p]).e*a<h||o.s*a>h+s);else n=o.s*a<=h?0:(o.s*a-h)/s,l=o.e*a>=h+s?1:(o.e*a-h)/s,r.push([n,l])}return r.length||r.push([0,0]),r},TrimModifier.prototype.processShapes=function(e){var t,s,h,a,i,p=this.shapes.length,o=this.sValue,r=this.eValue,d=0;if(r===o)for(s=0;s<p;s+=1)this.shapes[s].localShapeCollection.releaseShapes(),this.shapes[s].shape.mdf=!0,this.shapes[s].shape.paths=this.shapes[s].localShapeCollection;else if(1===r&&0===o||0===r&&1===o){if(this.mdf)for(s=0;s<p;s+=1)this.shapes[s].shape.mdf=!0}else{var n,l,f=[];for(s=0;s<p;s+=1)if((n=this.shapes[s]).shape.mdf||this.mdf||e||2===this.m){if(m=(t=n.shape.paths)._length,i=0,!n.shape.mdf&&n.pathsData)i=n.totalShapeLength;else{for(h=[],g=0;g<m;g+=1)a=bez.getSegmentsLength(t.shapes[g]),h.push(a),i+=a.totalLength;n.totalShapeLength=i,n.pathsData=h}d+=i,n.shape.mdf=!0}else n.shape.paths=n.localShapeCollection;var g,m,c=o,S=r,u=0;for(s=p-1;s>=0;s-=1)if((n=this.shapes[s]).shape.mdf){if((l=n.localShapeCollection).releaseShapes(),2===this.m&&p>1){var v=this.calculateShapeEdges(o,r,n.totalShapeLength,u,d);u+=n.totalShapeLength}else v=[[c,S]];for(m=v.length,g=0;g<m;g+=1){c=v[g][0],S=v[g][1],f.length=0,S<=1?f.push({s:n.totalShapeLength*c,e:n.totalShapeLength*S}):c>=1?f.push({s:n.totalShapeLength*(c-1),e:n.totalShapeLength*(S-1)}):(f.push({s:n.totalShapeLength*c,e:n.totalShapeLength}),f.push({s:0,e:n.totalShapeLength*(S-1)}));var y=this.addShapes(n,f[0]);if(f[0].s!==f[0].e){if(f.length>1)if(n.shape.v.c){var L=y.pop();this.addPaths(y,l),y=this.addShapes(n,f[1],L)}else this.addPaths(y,l),y=this.addShapes(n,f[1]);this.addPaths(y,l)}}n.shape.paths=l}}this.dynamicProperties.length||(this.mdf=!1)},TrimModifier.prototype.addPaths=function(e,t){var s,h=e.length;for(s=0;s<h;s+=1)t.addShape(e[s])},TrimModifier.prototype.addSegment=function(e,t,s,h,a,i,p){a.setXYAt(t[0],t[1],"o",i),a.setXYAt(s[0],s[1],"i",i+1),p&&a.setXYAt(e[0],e[1],"v",i),a.setXYAt(h[0],h[1],"v",i+1)},TrimModifier.prototype.addShapes=function(e,t,s){var h,a,i,p,o,r,d,n,l=e.pathsData,f=e.shape.paths.shapes,g=e.shape.paths._length,m=0,c=[],S=!0;for(s?(o=s._length,n=s._length):(s=shape_pool.newShape(),o=0,n=0),c.push(s),h=0;h<g;h+=1){for(r=l[h].lengths,s.c=f[h].c,i=f[h].c?r.length:r.length+1,a=1;a<i;a+=1)if(m+(p=r[a-1]).addedLength<t.s)m+=p.addedLength,s.c=!1;else{if(m>t.e){s.c=!1;break}t.s<=m&&t.e>=m+p.addedLength?(this.addSegment(f[h].v[a-1],f[h].o[a-1],f[h].i[a],f[h].v[a],s,o,S),S=!1):(d=bez.getNewSegment(f[h].v[a-1],f[h].v[a],f[h].o[a-1],f[h].i[a],(t.s-m)/p.addedLength,(t.e-m)/p.addedLength,r[a-1]),this.addSegment(d.pt1,d.pt3,d.pt4,d.pt2,s,o,S),S=!1,s.c=!1),m+=p.addedLength,o+=1}if(f[h].c){if(p=r[a-1],m<=t.e){var u=r[a-1].addedLength;t.s<=m&&t.e>=m+u?(this.addSegment(f[h].v[a-1],f[h].o[a-1],f[h].i[0],f[h].v[0],s,o,S),S=!1):(d=bez.getNewSegment(f[h].v[a-1],f[h].v[0],f[h].o[a-1],f[h].i[0],(t.s-m)/u,(t.e-m)/u,r[a-1]),this.addSegment(d.pt1,d.pt3,d.pt4,d.pt2,s,o,S),S=!1,s.c=!1)}else s.c=!1;m+=p.addedLength,o+=1}if(s._length&&(s.setXYAt(s.v[n][0],s.v[n][1],"i",n),s.setXYAt(s.v[s._length-1][0],s.v[s._length-1][1],"o",s._length-1)),m>t.e)break;h<g-1&&(s=shape_pool.newShape(),S=!0,c.push(s),o=0)}return c},ShapeModifiers.registerModifier("tm",TrimModifier);
//# sourceMappingURL=/sm/1300ec4610667e34ddcee5768fc0b4c337a2eeb1ba36af038fa6e92b4cacef70.map